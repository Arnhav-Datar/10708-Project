INFO:root:Namespace(lm_model='bert-base-uncased', N=50, max_len=128, z_dim=8, mha_dim=768, n_heads=8, hid_dims=[128, 256, 768], hid_dims_2=[512, 256, 128], m_dim=128, conv_dim=[[128, 256], 768, [256, 64]], lambda_gp=10.0, post_method='sigmoid', batch_size=128, num_epochs=100, g_lr=0.0002, d_lr=5e-05, dropout=0.0, n_critic=5, resume_epoch=None, test_epochs=100, num_workers=1, mode='train', data_dir='data', saving_dir='results/2023-04-07', log_step=1, sample_step=1000, model_save_step=20, lr_update_step=1000, lambda_wgan=1, log_dir='results/2023-04-07/logs', model_dir='results/2023-04-07/models')
INFO:root:Generator(
  (activation_f): Tanh()
  (multi_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=8, out_features=128, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): Tanh()
      (3): Linear(in_features=128, out_features=256, bias=True)
      (4): Dropout(p=0.0, inplace=False)
      (5): Tanh()
      (6): Linear(in_features=256, out_features=768, bias=True)
      (7): Dropout(p=0.0, inplace=False)
      (8): Tanh()
    )
  )
  (mha): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
  )
  (multi_dense_layer_2): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=768, out_features=512, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): Tanh()
      (3): Linear(in_features=512, out_features=256, bias=True)
      (4): Dropout(p=0.0, inplace=False)
      (5): Tanh()
      (6): Linear(in_features=256, out_features=128, bias=True)
      (7): Dropout(p=0.0, inplace=False)
      (8): Tanh()
    )
  )
  (adjM_layer): Linear(in_features=128, out_features=2500, bias=True)
  (dropoout): Dropout(p=0.0, inplace=False)
)
INFO:root:G
INFO:root:The number of parameters: 3474372
INFO:root:Discriminator(
  (activation_f): Tanh()
  (gcn_layer): GraphConvolution(
    (activation_f): Tanh()
    (multi_graph_convolution_layers): MultiGraphConvolutionLayers(
      (conv_nets): ModuleList(
        (0): GraphConvolutionLayer(
          (adj_list): Linear(in_features=128, out_features=128, bias=True)
          (linear_2): Linear(in_features=128, out_features=128, bias=True)
          (activation): Tanh()
          (dropout): Dropout(p=0.0, inplace=False)
          (pe): PositionalEncoder()
        )
        (1): GraphConvolutionLayer(
          (adj_list): Linear(in_features=128, out_features=256, bias=True)
          (linear_2): Linear(in_features=128, out_features=256, bias=True)
          (activation): Tanh()
          (dropout): Dropout(p=0.0, inplace=False)
          (pe): PositionalEncoder()
        )
      )
    )
  )
  (agg_layer): GraphAggregation(
    (activation): Tanh()
    (i): Sequential(
      (0): Linear(in_features=256, out_features=768, bias=True)
      (1): Sigmoid()
    )
    (j): Sequential(
      (0): Linear(in_features=256, out_features=768, bias=True)
      (1): Tanh()
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (mha): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
  )
  (multi_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=768, out_features=256, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): Tanh()
      (3): Linear(in_features=256, out_features=64, bias=True)
      (4): Dropout(p=0.0, inplace=False)
      (5): Tanh()
    )
  )
  (output_layer): Linear(in_features=64, out_features=1, bias=True)
)
INFO:root:D
INFO:root:The number of parameters: 3069569
INFO:root:BertModel(
  (embeddings): BertEmbeddings(
    (word_embeddings): Embedding(30522, 768, padding_idx=0)
    (position_embeddings): Embedding(512, 768)
    (token_type_embeddings): Embedding(2, 768)
    (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (encoder): BertEncoder(
    (layer): ModuleList(
      (0-11): 12 x BertLayer(
        (attention): BertAttention(
          (self): BertSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (output): BertSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (intermediate): BertIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): BertOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (pooler): BertPooler(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (activation): Tanh()
  )
)
INFO:root:bert-base-uncased
INFO:root:The number of parameters: 109482240
INFO:root:Elapsed [0:05:41], Iteration [1/100]:
l_D/R: 5.64, l_D/F: -5.86, l_D: -11.09, l_G: 5.86
INFO:root:Elapsed [0:11:25], Iteration [2/100]:
l_D/R: 2.31, l_D/F: -0.56, l_D: -2.50, l_G: 0.56
INFO:root:Elapsed [0:17:09], Iteration [3/100]:
l_D/R: -0.13, l_D/F: -2.67, l_D: -2.10, l_G: 2.67
INFO:root:Elapsed [0:22:53], Iteration [4/100]:
l_D/R: -1.34, l_D/F: -3.50, l_D: -1.93, l_G: 3.50
INFO:root:Elapsed [0:28:38], Iteration [5/100]:
l_D/R: -1.27, l_D/F: -4.22, l_D: -2.66, l_G: 4.22
INFO:root:Elapsed [0:34:22], Iteration [6/100]:
l_D/R: -0.74, l_D/F: -4.13, l_D: -3.07, l_G: 4.13
INFO:root:Elapsed [0:40:07], Iteration [7/100]:
l_D/R: -1.49, l_D/F: -4.40, l_D: -2.76, l_G: 4.40
INFO:root:Elapsed [0:45:51], Iteration [8/100]:
l_D/R: -0.97, l_D/F: -4.62, l_D: -3.25, l_G: 4.62
INFO:root:Elapsed [0:51:36], Iteration [9/100]:
l_D/R: -1.62, l_D/F: -5.06, l_D: -3.12, l_G: 5.06
INFO:root:Elapsed [0:57:19], Iteration [10/100]:
l_D/R: -1.33, l_D/F: -5.10, l_D: -3.25, l_G: 5.10
INFO:root:Elapsed [1:03:04], Iteration [11/100]:
l_D/R: -0.57, l_D/F: -4.59, l_D: -3.53, l_G: 4.59
INFO:root:Elapsed [1:08:48], Iteration [12/100]:
l_D/R: -1.14, l_D/F: -5.46, l_D: -3.70, l_G: 5.46
INFO:root:Elapsed [1:14:32], Iteration [13/100]:
l_D/R: -1.12, l_D/F: -5.14, l_D: -3.78, l_G: 5.14
INFO:root:Elapsed [1:20:16], Iteration [14/100]:
l_D/R: -1.68, l_D/F: -5.67, l_D: -3.73, l_G: 5.67
INFO:root:Elapsed [1:26:01], Iteration [15/100]:
l_D/R: -1.52, l_D/F: -6.02, l_D: -3.87, l_G: 6.02
INFO:root:Elapsed [1:31:45], Iteration [16/100]:
l_D/R: -1.88, l_D/F: -6.08, l_D: -3.80, l_G: 6.08
INFO:root:Elapsed [1:37:29], Iteration [17/100]:
l_D/R: -1.42, l_D/F: -5.62, l_D: -3.94, l_G: 5.62
INFO:root:Elapsed [1:43:13], Iteration [18/100]:
l_D/R: -1.53, l_D/F: -6.22, l_D: -3.98, l_G: 6.22
INFO:root:Elapsed [1:48:57], Iteration [19/100]:
l_D/R: -1.80, l_D/F: -6.22, l_D: -3.87, l_G: 6.22
INFO:root:Saved model checkpoints into results/2023-04-07/models...
INFO:root:Elapsed [2:13:57], Iteration [20/100]:
l_D/R: -1.26, l_D/F: -6.09, l_D: -4.13, l_G: 6.09
property_match: 0.14
INFO:root:Elapsed [2:19:40], Iteration [21/100]:
l_D/R: -1.77, l_D/F: -6.08, l_D: -3.93, l_G: 6.08
INFO:root:Elapsed [2:25:23], Iteration [22/100]:
l_D/R: -1.85, l_D/F: -6.03, l_D: -3.94, l_G: 6.03
INFO:root:Elapsed [2:31:07], Iteration [23/100]:
l_D/R: -1.58, l_D/F: -6.61, l_D: -4.25, l_G: 6.61
INFO:root:Elapsed [2:36:51], Iteration [24/100]:
l_D/R: -1.59, l_D/F: -6.62, l_D: -4.27, l_G: 6.62
INFO:root:Elapsed [2:42:34], Iteration [25/100]:
l_D/R: -1.91, l_D/F: -6.78, l_D: -4.33, l_G: 6.78
INFO:root:Elapsed [2:48:19], Iteration [26/100]:
l_D/R: -1.77, l_D/F: -6.59, l_D: -4.31, l_G: 6.59
INFO:root:Elapsed [2:54:02], Iteration [27/100]:
l_D/R: -1.95, l_D/F: -6.50, l_D: -4.21, l_G: 6.50
INFO:root:Elapsed [2:59:46], Iteration [28/100]:
l_D/R: -1.65, l_D/F: -6.72, l_D: -4.41, l_G: 6.72
INFO:root:Elapsed [3:05:30], Iteration [29/100]:
l_D/R: -1.84, l_D/F: -6.68, l_D: -4.43, l_G: 6.68
INFO:root:Elapsed [3:11:14], Iteration [30/100]:
l_D/R: -2.03, l_D/F: -6.75, l_D: -4.40, l_G: 6.75
INFO:root:Elapsed [3:16:58], Iteration [31/100]:
l_D/R: -1.82, l_D/F: -6.82, l_D: -4.46, l_G: 6.82
INFO:root:Elapsed [3:22:42], Iteration [32/100]:
l_D/R: -1.81, l_D/F: -7.04, l_D: -4.53, l_G: 7.04
INFO:root:Elapsed [3:28:25], Iteration [33/100]:
l_D/R: -1.90, l_D/F: -6.81, l_D: -4.41, l_G: 6.81
INFO:root:Elapsed [3:34:09], Iteration [34/100]:
l_D/R: -1.72, l_D/F: -6.92, l_D: -4.50, l_G: 6.92
INFO:root:Elapsed [3:39:53], Iteration [35/100]:
l_D/R: -1.82, l_D/F: -7.05, l_D: -4.56, l_G: 7.05
INFO:root:Elapsed [3:45:37], Iteration [36/100]:
l_D/R: -2.00, l_D/F: -7.09, l_D: -4.52, l_G: 7.09
INFO:root:Elapsed [3:51:20], Iteration [37/100]:
l_D/R: -1.96, l_D/F: -7.18, l_D: -4.60, l_G: 7.18
INFO:root:Elapsed [3:57:04], Iteration [38/100]:
l_D/R: -1.84, l_D/F: -7.22, l_D: -4.59, l_G: 7.22
INFO:root:Elapsed [4:02:48], Iteration [39/100]:
l_D/R: -2.15, l_D/F: -7.20, l_D: -4.53, l_G: 7.20
INFO:root:Saved model checkpoints into results/2023-04-07/models...
INFO:root:Elapsed [4:27:47], Iteration [40/100]:
l_D/R: -1.98, l_D/F: -7.28, l_D: -4.62, l_G: 7.28
property_match: 0.17
INFO:root:Elapsed [4:33:41], Iteration [41/100]:
l_D/R: -2.11, l_D/F: -7.53, l_D: -4.61, l_G: 7.53
INFO:root:Elapsed [4:39:37], Iteration [42/100]:
l_D/R: -2.25, l_D/F: -7.49, l_D: -4.60, l_G: 7.49
INFO:root:Elapsed [4:45:32], Iteration [43/100]:
l_D/R: -2.11, l_D/F: -7.52, l_D: -4.63, l_G: 7.52
INFO:root:Elapsed [4:51:28], Iteration [44/100]:
l_D/R: -2.06, l_D/F: -7.57, l_D: -4.62, l_G: 7.57
INFO:root:Elapsed [4:57:23], Iteration [45/100]:
l_D/R: -2.00, l_D/F: -7.20, l_D: -4.66, l_G: 7.20
INFO:root:Elapsed [5:03:19], Iteration [46/100]:
l_D/R: -2.35, l_D/F: -7.47, l_D: -4.64, l_G: 7.47
INFO:root:Elapsed [5:09:15], Iteration [47/100]:
l_D/R: -1.79, l_D/F: -7.09, l_D: -4.68, l_G: 7.09
INFO:root:Elapsed [5:15:10], Iteration [48/100]:
l_D/R: -2.01, l_D/F: -7.36, l_D: -4.69, l_G: 7.36
INFO:root:Elapsed [5:21:06], Iteration [49/100]:
l_D/R: -2.15, l_D/F: -7.69, l_D: -4.71, l_G: 7.69
INFO:root:Elapsed [5:27:01], Iteration [50/100]:
l_D/R: -2.07, l_D/F: -7.31, l_D: -4.72, l_G: 7.31
INFO:root:Elapsed [5:32:56], Iteration [51/100]:
l_D/R: -2.21, l_D/F: -7.60, l_D: -4.71, l_G: 7.60
INFO:root:Elapsed [5:38:51], Iteration [52/100]:
l_D/R: -1.93, l_D/F: -7.23, l_D: -4.65, l_G: 7.23
INFO:root:Elapsed [5:44:47], Iteration [53/100]:
l_D/R: -2.59, l_D/F: -7.76, l_D: -4.64, l_G: 7.76
INFO:root:Elapsed [5:50:43], Iteration [54/100]:
l_D/R: -2.28, l_D/F: -7.61, l_D: -4.73, l_G: 7.61
INFO:root:Elapsed [5:56:38], Iteration [55/100]:
l_D/R: -2.47, l_D/F: -7.98, l_D: -4.75, l_G: 7.98
INFO:root:Elapsed [6:02:38], Iteration [56/100]:
l_D/R: -2.18, l_D/F: -7.64, l_D: -4.79, l_G: 7.64
INFO:root:Elapsed [6:08:38], Iteration [57/100]:
l_D/R: -2.04, l_D/F: -7.54, l_D: -4.80, l_G: 7.54
INFO:root:Elapsed [6:14:38], Iteration [58/100]:
l_D/R: -1.77, l_D/F: -7.33, l_D: -4.81, l_G: 7.33
INFO:root:Elapsed [6:20:38], Iteration [59/100]:
l_D/R: -2.11, l_D/F: -7.59, l_D: -4.76, l_G: 7.59
INFO:root:Saved model checkpoints into results/2023-04-07/models...
INFO:root:Elapsed [6:45:48], Iteration [60/100]:
l_D/R: -2.37, l_D/F: -7.85, l_D: -4.79, l_G: 7.85
property_match: 0.17
INFO:root:Elapsed [6:51:50], Iteration [61/100]:
l_D/R: -1.79, l_D/F: -7.47, l_D: -4.74, l_G: 7.47
INFO:root:Elapsed [6:57:55], Iteration [62/100]:
l_D/R: -2.03, l_D/F: -7.37, l_D: -4.76, l_G: 7.37
INFO:root:Elapsed [7:04:00], Iteration [63/100]:
l_D/R: -2.23, l_D/F: -7.43, l_D: -4.75, l_G: 7.43
INFO:root:Elapsed [7:10:06], Iteration [64/100]:
l_D/R: -2.38, l_D/F: -7.87, l_D: -4.80, l_G: 7.87
INFO:root:Elapsed [7:16:11], Iteration [65/100]:
l_D/R: -2.07, l_D/F: -7.65, l_D: -4.79, l_G: 7.65
INFO:root:Elapsed [7:22:17], Iteration [66/100]:
l_D/R: -2.51, l_D/F: -7.88, l_D: -4.79, l_G: 7.88
INFO:root:Elapsed [7:28:22], Iteration [67/100]:
l_D/R: -2.16, l_D/F: -7.73, l_D: -4.80, l_G: 7.73
INFO:root:Elapsed [7:34:28], Iteration [68/100]:
l_D/R: -2.28, l_D/F: -7.86, l_D: -4.82, l_G: 7.86
INFO:root:Elapsed [7:40:33], Iteration [69/100]:
l_D/R: -2.21, l_D/F: -7.68, l_D: -4.82, l_G: 7.68
INFO:root:Elapsed [7:46:39], Iteration [70/100]:
l_D/R: -2.06, l_D/F: -7.59, l_D: -4.82, l_G: 7.59
INFO:root:Elapsed [7:52:44], Iteration [71/100]:
l_D/R: -2.34, l_D/F: -7.94, l_D: -4.82, l_G: 7.94
INFO:root:Elapsed [7:58:49], Iteration [72/100]:
l_D/R: -2.42, l_D/F: -7.81, l_D: -4.82, l_G: 7.81
INFO:root:Elapsed [8:04:54], Iteration [73/100]:
l_D/R: -2.02, l_D/F: -7.48, l_D: -4.85, l_G: 7.48
INFO:root:Elapsed [8:10:59], Iteration [74/100]:
l_D/R: -2.31, l_D/F: -7.73, l_D: -4.82, l_G: 7.73
INFO:root:Elapsed [8:17:04], Iteration [75/100]:
l_D/R: -2.49, l_D/F: -7.98, l_D: -4.82, l_G: 7.98
INFO:root:Elapsed [8:23:10], Iteration [76/100]:
l_D/R: -2.29, l_D/F: -7.77, l_D: -4.85, l_G: 7.77
INFO:root:Elapsed [8:29:15], Iteration [77/100]:
l_D/R: -1.89, l_D/F: -7.27, l_D: -4.83, l_G: 7.27
INFO:root:Elapsed [8:35:20], Iteration [78/100]:
l_D/R: -2.22, l_D/F: -7.86, l_D: -4.86, l_G: 7.86
INFO:root:Elapsed [8:41:26], Iteration [79/100]:
l_D/R: -2.07, l_D/F: -7.71, l_D: -4.87, l_G: 7.71
INFO:root:Saved model checkpoints into results/2023-04-07/models...
INFO:root:Elapsed [9:07:57], Iteration [80/100]:
l_D/R: -2.42, l_D/F: -7.95, l_D: -4.89, l_G: 7.95
property_match: 0.17
INFO:root:Elapsed [9:14:01], Iteration [81/100]:
l_D/R: -2.21, l_D/F: -7.75, l_D: -4.89, l_G: 7.75
INFO:root:Elapsed [9:20:05], Iteration [82/100]:
l_D/R: -2.12, l_D/F: -7.59, l_D: -4.88, l_G: 7.59
INFO:root:Elapsed [9:26:11], Iteration [83/100]:
l_D/R: -2.16, l_D/F: -7.78, l_D: -4.91, l_G: 7.78
INFO:root:Elapsed [9:32:16], Iteration [84/100]:
l_D/R: -2.44, l_D/F: -7.93, l_D: -4.91, l_G: 7.93
INFO:root:Elapsed [9:38:22], Iteration [85/100]:
l_D/R: -2.34, l_D/F: -7.79, l_D: -4.89, l_G: 7.79
INFO:root:Elapsed [9:44:27], Iteration [86/100]:
l_D/R: -2.43, l_D/F: -7.76, l_D: -4.87, l_G: 7.76
INFO:root:Elapsed [9:50:33], Iteration [87/100]:
l_D/R: -2.37, l_D/F: -7.88, l_D: -4.89, l_G: 7.88
INFO:root:Elapsed [9:56:38], Iteration [88/100]:
l_D/R: -2.36, l_D/F: -7.83, l_D: -4.90, l_G: 7.83
INFO:root:Elapsed [10:02:44], Iteration [89/100]:
l_D/R: -2.24, l_D/F: -7.80, l_D: -4.91, l_G: 7.80
INFO:root:Elapsed [10:08:49], Iteration [90/100]:
l_D/R: -2.35, l_D/F: -7.80, l_D: -4.90, l_G: 7.80
INFO:root:Elapsed [10:14:55], Iteration [91/100]:
l_D/R: -2.32, l_D/F: -7.87, l_D: -4.89, l_G: 7.87
INFO:root:Elapsed [10:21:01], Iteration [92/100]:
l_D/R: -2.26, l_D/F: -7.76, l_D: -4.91, l_G: 7.76
INFO:root:Elapsed [10:27:06], Iteration [93/100]:
l_D/R: -2.13, l_D/F: -7.68, l_D: -4.93, l_G: 7.68
INFO:root:Elapsed [10:33:11], Iteration [94/100]:
l_D/R: -2.13, l_D/F: -7.72, l_D: -4.94, l_G: 7.72
INFO:root:Elapsed [10:39:16], Iteration [95/100]:
l_D/R: -2.28, l_D/F: -7.90, l_D: -4.94, l_G: 7.90
INFO:root:Elapsed [10:45:22], Iteration [96/100]:
l_D/R: -2.23, l_D/F: -7.81, l_D: -4.94, l_G: 7.81
INFO:root:Elapsed [10:51:28], Iteration [97/100]:
l_D/R: -2.02, l_D/F: -7.66, l_D: -4.94, l_G: 7.66
INFO:root:Elapsed [10:57:33], Iteration [98/100]:
l_D/R: -2.14, l_D/F: -7.72, l_D: -4.95, l_G: 7.72
INFO:root:Elapsed [11:03:36], Iteration [99/100]:
l_D/R: -2.12, l_D/F: -7.75, l_D: -4.96, l_G: 7.75
INFO:root:Saved model checkpoints into results/2023-04-07/models...
INFO:root:Elapsed [11:30:10], Iteration [100/100]:
l_D/R: -2.12, l_D/F: -7.73, l_D: -4.95, l_G: 7.73
property_match: 0.17
