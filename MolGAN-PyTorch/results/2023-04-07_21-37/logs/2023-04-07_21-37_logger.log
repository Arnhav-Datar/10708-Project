INFO:root:Namespace(lm_model='bert-base-uncased', N=50, max_len=128, z_dim=8, mha_dim=768, n_heads=8, hid_dims=[128, 256, 768], hid_dims_2=[512, 256, 128], m_dim=128, conv_dim=[[128, 256], 768, [256, 64]], lambda_gp=10.0, post_method='sigmoid', batch_size=128, num_epochs=100, g_lr=0.0002, d_lr=0.0002, dropout=0.0, n_critic=5, resume_epoch=None, test_epochs=100, num_workers=1, mode='train', data_dir='data', saving_dir='results/2023-04-07_21-37', log_step=1, sample_step=1000, model_save_step=20, lr_update_step=1000, lambda_wgan=1, log_dir='results/2023-04-07_21-37/logs', model_dir='results/2023-04-07_21-37/models')
INFO:root:Generator(
  (activation_f): Tanh()
  (multi_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=8, out_features=128, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): Tanh()
      (3): Linear(in_features=128, out_features=256, bias=True)
      (4): Dropout(p=0.0, inplace=False)
      (5): Tanh()
      (6): Linear(in_features=256, out_features=768, bias=True)
      (7): Dropout(p=0.0, inplace=False)
      (8): Tanh()
    )
  )
  (mha): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
  )
  (multi_dense_layer_2): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=768, out_features=512, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): Tanh()
      (3): Linear(in_features=512, out_features=256, bias=True)
      (4): Dropout(p=0.0, inplace=False)
      (5): Tanh()
      (6): Linear(in_features=256, out_features=128, bias=True)
      (7): Dropout(p=0.0, inplace=False)
      (8): Tanh()
    )
  )
  (adjM_layer): Linear(in_features=128, out_features=2500, bias=True)
  (dropoout): Dropout(p=0.0, inplace=False)
)
INFO:root:G
INFO:root:The number of parameters: 3474372
INFO:root:Discriminator(
  (activation_f): Tanh()
  (gcn_layer): GraphConvolution(
    (activation_f): Tanh()
    (multi_graph_convolution_layers): MultiGraphConvolutionLayers(
      (conv_nets): ModuleList(
        (0): GraphConvolutionLayer(
          (adj_list): Linear(in_features=128, out_features=128, bias=True)
          (linear_2): Linear(in_features=128, out_features=128, bias=True)
          (activation): Tanh()
          (dropout): Dropout(p=0.0, inplace=False)
          (pe): PositionalEncoder()
        )
        (1): GraphConvolutionLayer(
          (adj_list): Linear(in_features=128, out_features=256, bias=True)
          (linear_2): Linear(in_features=128, out_features=256, bias=True)
          (activation): Tanh()
          (dropout): Dropout(p=0.0, inplace=False)
          (pe): PositionalEncoder()
        )
      )
    )
  )
  (agg_layer): GraphAggregation(
    (activation): Tanh()
    (i): Sequential(
      (0): Linear(in_features=256, out_features=768, bias=True)
      (1): Sigmoid()
    )
    (j): Sequential(
      (0): Linear(in_features=256, out_features=768, bias=True)
      (1): Tanh()
    )
    (dropout): Dropout(p=0.0, inplace=False)
  )
  (mha): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
  )
  (multi_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=768, out_features=256, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): Tanh()
      (3): Linear(in_features=256, out_features=64, bias=True)
      (4): Dropout(p=0.0, inplace=False)
      (5): Tanh()
    )
  )
  (output_layer): Linear(in_features=64, out_features=1, bias=True)
)
INFO:root:D
INFO:root:The number of parameters: 3069569
INFO:root:BertModel(
  (embeddings): BertEmbeddings(
    (word_embeddings): Embedding(30522, 768, padding_idx=0)
    (position_embeddings): Embedding(512, 768)
    (token_type_embeddings): Embedding(2, 768)
    (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (encoder): BertEncoder(
    (layer): ModuleList(
      (0-11): 12 x BertLayer(
        (attention): BertAttention(
          (self): BertSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (output): BertSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (intermediate): BertIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): BertOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (pooler): BertPooler(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (activation): Tanh()
  )
)
INFO:root:bert-base-uncased
INFO:root:The number of parameters: 109482240
INFO:root:Elapsed [0:05:41], Iteration [1/100]:
l_D/R: 4.99, l_D/F: -5.39, l_D: -9.14, l_G: 5.39
INFO:root:Elapsed [0:11:26], Iteration [2/100]:
l_D/R: 5.64, l_D/F: 3.05, l_D: -2.15, l_G: -3.05
INFO:root:Elapsed [0:17:09], Iteration [3/100]:
l_D/R: 4.33, l_D/F: 1.19, l_D: -2.46, l_G: -1.19
INFO:root:Elapsed [0:22:53], Iteration [4/100]:
l_D/R: 3.88, l_D/F: -0.01, l_D: -3.15, l_G: 0.01
INFO:root:Elapsed [0:28:37], Iteration [5/100]:
l_D/R: 4.06, l_D/F: -0.04, l_D: -3.28, l_G: 0.04
INFO:root:Elapsed [0:34:22], Iteration [6/100]:
l_D/R: 2.57, l_D/F: -1.94, l_D: -3.44, l_G: 1.94
INFO:root:Elapsed [0:40:08], Iteration [7/100]:
l_D/R: 3.54, l_D/F: -0.60, l_D: -3.73, l_G: 0.60
INFO:root:Elapsed [0:45:53], Iteration [8/100]:
l_D/R: 6.19, l_D/F: 0.51, l_D: -4.86, l_G: -0.51
INFO:root:Elapsed [0:51:37], Iteration [9/100]:
l_D/R: 2.42, l_D/F: -0.89, l_D: -2.99, l_G: 0.89
INFO:root:Elapsed [0:57:21], Iteration [10/100]:
l_D/R: 2.52, l_D/F: -1.02, l_D: -3.33, l_G: 1.02
INFO:root:Elapsed [1:03:06], Iteration [11/100]:
l_D/R: 3.41, l_D/F: -0.61, l_D: -3.17, l_G: 0.61
INFO:root:Elapsed [1:08:50], Iteration [12/100]:
l_D/R: 2.44, l_D/F: -1.11, l_D: -3.30, l_G: 1.11
INFO:root:Elapsed [1:14:34], Iteration [13/100]:
l_D/R: 3.07, l_D/F: -0.75, l_D: -3.51, l_G: 0.75
INFO:root:Elapsed [1:20:18], Iteration [14/100]:
l_D/R: 2.99, l_D/F: -0.97, l_D: -3.48, l_G: 0.97
INFO:root:Elapsed [1:26:02], Iteration [15/100]:
l_D/R: 3.13, l_D/F: -1.33, l_D: -3.48, l_G: 1.33
INFO:root:Elapsed [1:31:46], Iteration [16/100]:
l_D/R: 2.40, l_D/F: -1.41, l_D: -3.40, l_G: 1.41
INFO:root:Elapsed [1:37:31], Iteration [17/100]:
l_D/R: 2.76, l_D/F: -0.90, l_D: -3.47, l_G: 0.90
INFO:root:Elapsed [1:43:15], Iteration [18/100]:
l_D/R: 2.66, l_D/F: -1.47, l_D: -3.59, l_G: 1.47
INFO:root:Elapsed [1:49:00], Iteration [19/100]:
l_D/R: 2.92, l_D/F: -1.05, l_D: -3.56, l_G: 1.05
INFO:root:Saved model checkpoints into results/2023-04-07_21-37/models...
INFO:root:Elapsed [2:15:38], Iteration [20/100]:
l_D/R: 2.12, l_D/F: -1.63, l_D: -3.46, l_G: 1.63
property_match: 0.12
INFO:root:Elapsed [2:21:19], Iteration [21/100]:
l_D/R: 3.19, l_D/F: -1.04, l_D: -3.85, l_G: 1.04
INFO:root:Elapsed [2:27:04], Iteration [22/100]:
l_D/R: 2.97, l_D/F: -1.81, l_D: -3.67, l_G: 1.81
INFO:root:Elapsed [2:32:48], Iteration [23/100]:
l_D/R: 2.89, l_D/F: -1.57, l_D: -3.90, l_G: 1.57
INFO:root:Elapsed [2:38:32], Iteration [24/100]:
l_D/R: 2.97, l_D/F: -1.77, l_D: -3.86, l_G: 1.77
INFO:root:Elapsed [2:44:17], Iteration [25/100]:
l_D/R: 2.77, l_D/F: -2.08, l_D: -3.79, l_G: 2.08
INFO:root:Elapsed [2:50:01], Iteration [26/100]:
l_D/R: 3.41, l_D/F: -0.50, l_D: -3.64, l_G: 0.50
INFO:root:Elapsed [2:55:46], Iteration [27/100]:
l_D/R: 2.85, l_D/F: -1.66, l_D: -3.89, l_G: 1.66
INFO:root:Elapsed [3:01:30], Iteration [28/100]:
l_D/R: 3.04, l_D/F: -1.17, l_D: -3.99, l_G: 1.17
INFO:root:Elapsed [3:07:15], Iteration [29/100]:
l_D/R: 2.97, l_D/F: -1.98, l_D: -3.88, l_G: 1.98
INFO:root:Elapsed [3:12:59], Iteration [30/100]:
l_D/R: 3.06, l_D/F: -1.86, l_D: -3.96, l_G: 1.86
INFO:root:Elapsed [3:18:44], Iteration [31/100]:
l_D/R: 3.01, l_D/F: -1.47, l_D: -4.01, l_G: 1.47
INFO:root:Elapsed [3:24:29], Iteration [32/100]:
l_D/R: 2.73, l_D/F: -1.88, l_D: -3.87, l_G: 1.88
INFO:root:Elapsed [3:30:13], Iteration [33/100]:
l_D/R: 2.86, l_D/F: -1.69, l_D: -3.80, l_G: 1.69
INFO:root:Elapsed [3:35:58], Iteration [34/100]:
l_D/R: 3.41, l_D/F: -0.68, l_D: -3.77, l_G: 0.68
INFO:root:Elapsed [3:41:42], Iteration [35/100]:
l_D/R: 3.05, l_D/F: -0.83, l_D: -3.62, l_G: 0.83
INFO:root:Elapsed [3:47:26], Iteration [36/100]:
l_D/R: 3.03, l_D/F: -1.45, l_D: -3.66, l_G: 1.45
INFO:root:Elapsed [3:53:10], Iteration [37/100]:
l_D/R: 3.04, l_D/F: -1.57, l_D: -3.74, l_G: 1.57
INFO:root:Elapsed [3:58:55], Iteration [38/100]:
l_D/R: 3.11, l_D/F: -1.37, l_D: -3.78, l_G: 1.37
INFO:root:Elapsed [4:04:39], Iteration [39/100]:
l_D/R: 3.51, l_D/F: -0.83, l_D: -3.80, l_G: 0.83
INFO:root:Saved model checkpoints into results/2023-04-07_21-37/models...
INFO:root:Elapsed [4:31:17], Iteration [40/100]:
l_D/R: 3.20, l_D/F: -1.13, l_D: -3.79, l_G: 1.13
property_match: 0.14
INFO:root:Elapsed [4:36:58], Iteration [41/100]:
l_D/R: 3.26, l_D/F: -0.72, l_D: -3.73, l_G: 0.72
INFO:root:Elapsed [4:42:40], Iteration [42/100]:
l_D/R: 3.17, l_D/F: -0.83, l_D: -3.67, l_G: 0.83
INFO:root:Elapsed [4:48:22], Iteration [43/100]:
l_D/R: 3.37, l_D/F: -1.12, l_D: -3.86, l_G: 1.12
INFO:root:Elapsed [4:54:03], Iteration [44/100]:
l_D/R: 2.97, l_D/F: -1.66, l_D: -3.75, l_G: 1.66
INFO:root:Elapsed [4:59:44], Iteration [45/100]:
l_D/R: 3.27, l_D/F: -1.08, l_D: -3.87, l_G: 1.08
INFO:root:Elapsed [5:05:26], Iteration [46/100]:
l_D/R: 3.46, l_D/F: -0.67, l_D: -3.77, l_G: 0.67
INFO:root:Elapsed [5:11:07], Iteration [47/100]:
l_D/R: 3.22, l_D/F: -0.94, l_D: -3.80, l_G: 0.94
INFO:root:Elapsed [5:16:48], Iteration [48/100]:
l_D/R: 3.38, l_D/F: -1.31, l_D: -3.85, l_G: 1.31
INFO:root:Elapsed [5:22:30], Iteration [49/100]:
l_D/R: 3.28, l_D/F: -0.83, l_D: -3.77, l_G: 0.83
INFO:root:Elapsed [5:28:11], Iteration [50/100]:
l_D/R: 3.13, l_D/F: -1.43, l_D: -3.96, l_G: 1.43
INFO:root:Elapsed [5:33:53], Iteration [51/100]:
l_D/R: 3.10, l_D/F: -1.45, l_D: -3.90, l_G: 1.45
INFO:root:Elapsed [5:39:34], Iteration [52/100]:
l_D/R: 3.30, l_D/F: -1.34, l_D: -3.92, l_G: 1.34
INFO:root:Elapsed [5:45:15], Iteration [53/100]:
l_D/R: 3.51, l_D/F: -0.71, l_D: -3.85, l_G: 0.71
INFO:root:Elapsed [5:50:57], Iteration [54/100]:
l_D/R: 3.41, l_D/F: -1.26, l_D: -3.92, l_G: 1.26
INFO:root:Elapsed [5:56:38], Iteration [55/100]:
l_D/R: 3.20, l_D/F: -1.58, l_D: -3.95, l_G: 1.58
INFO:root:Elapsed [6:02:20], Iteration [56/100]:
l_D/R: 3.36, l_D/F: -1.37, l_D: -4.04, l_G: 1.37
INFO:root:Elapsed [6:08:01], Iteration [57/100]:
l_D/R: 2.88, l_D/F: -1.64, l_D: -3.97, l_G: 1.64
INFO:root:Elapsed [6:13:42], Iteration [58/100]:
l_D/R: 3.29, l_D/F: -1.38, l_D: -4.04, l_G: 1.38
INFO:root:Elapsed [6:19:23], Iteration [59/100]:
l_D/R: 3.38, l_D/F: -0.91, l_D: -3.87, l_G: 0.91
INFO:root:Saved model checkpoints into results/2023-04-07_21-37/models...
INFO:root:Elapsed [6:44:29], Iteration [60/100]:
l_D/R: 3.06, l_D/F: -1.77, l_D: -4.01, l_G: 1.77
property_match: 0.13
INFO:root:Elapsed [6:50:08], Iteration [61/100]:
l_D/R: 3.71, l_D/F: -0.55, l_D: -3.93, l_G: 0.55
INFO:root:Elapsed [6:55:50], Iteration [62/100]:
l_D/R: 3.73, l_D/F: -0.55, l_D: -3.96, l_G: 0.55
INFO:root:Elapsed [7:01:31], Iteration [63/100]:
l_D/R: 3.44, l_D/F: -1.23, l_D: -4.05, l_G: 1.23
INFO:root:Elapsed [7:07:13], Iteration [64/100]:
l_D/R: 2.94, l_D/F: -1.98, l_D: -3.97, l_G: 1.98
INFO:root:Elapsed [7:12:54], Iteration [65/100]:
l_D/R: 3.39, l_D/F: -1.34, l_D: -4.07, l_G: 1.34
INFO:root:Elapsed [7:18:35], Iteration [66/100]:
l_D/R: 3.45, l_D/F: -1.27, l_D: -4.13, l_G: 1.27
INFO:root:Elapsed [7:24:17], Iteration [67/100]:
l_D/R: 3.61, l_D/F: -1.02, l_D: -4.12, l_G: 1.02
INFO:root:Elapsed [7:29:59], Iteration [68/100]:
l_D/R: 3.47, l_D/F: -1.36, l_D: -4.16, l_G: 1.36
INFO:root:Elapsed [7:35:41], Iteration [69/100]:
l_D/R: 3.54, l_D/F: -1.01, l_D: -4.08, l_G: 1.01
INFO:root:Elapsed [7:41:22], Iteration [70/100]:
l_D/R: 3.43, l_D/F: -1.71, l_D: -4.11, l_G: 1.71
INFO:root:Elapsed [7:47:03], Iteration [71/100]:
l_D/R: 3.55, l_D/F: -1.04, l_D: -4.11, l_G: 1.04
INFO:root:Elapsed [7:52:45], Iteration [72/100]:
l_D/R: 3.25, l_D/F: -1.70, l_D: -4.15, l_G: 1.70
INFO:root:Elapsed [7:58:27], Iteration [73/100]:
l_D/R: 3.66, l_D/F: -0.91, l_D: -4.13, l_G: 0.91
INFO:root:Elapsed [8:04:08], Iteration [74/100]:
l_D/R: 3.53, l_D/F: -1.18, l_D: -4.24, l_G: 1.18
INFO:root:Elapsed [8:09:49], Iteration [75/100]:
l_D/R: 3.25, l_D/F: -1.76, l_D: -4.22, l_G: 1.76
INFO:root:Elapsed [8:15:31], Iteration [76/100]:
l_D/R: 3.28, l_D/F: -1.77, l_D: -4.19, l_G: 1.77
INFO:root:Elapsed [8:21:12], Iteration [77/100]:
l_D/R: 3.64, l_D/F: -1.47, l_D: -4.14, l_G: 1.47
INFO:root:Elapsed [8:26:54], Iteration [78/100]:
l_D/R: 3.52, l_D/F: -0.93, l_D: -4.06, l_G: 0.93
INFO:root:Elapsed [8:32:35], Iteration [79/100]:
l_D/R: 3.53, l_D/F: -1.31, l_D: -4.27, l_G: 1.31
INFO:root:Saved model checkpoints into results/2023-04-07_21-37/models...
INFO:root:Elapsed [8:57:40], Iteration [80/100]:
l_D/R: 4.01, l_D/F: -0.52, l_D: -4.19, l_G: 0.52
property_match: 0.14
INFO:root:Elapsed [9:03:20], Iteration [81/100]:
l_D/R: 3.74, l_D/F: -0.81, l_D: -4.16, l_G: 0.81
INFO:root:Elapsed [9:09:02], Iteration [82/100]:
l_D/R: 3.62, l_D/F: -1.15, l_D: -4.30, l_G: 1.15
INFO:root:Elapsed [9:14:43], Iteration [83/100]:
l_D/R: 3.54, l_D/F: -1.53, l_D: -4.32, l_G: 1.53
INFO:root:Elapsed [9:20:25], Iteration [84/100]:
l_D/R: 3.32, l_D/F: -1.61, l_D: -4.30, l_G: 1.61
INFO:root:Elapsed [9:26:06], Iteration [85/100]:
l_D/R: 3.59, l_D/F: -1.62, l_D: -4.26, l_G: 1.62
INFO:root:Elapsed [9:31:48], Iteration [86/100]:
l_D/R: 3.94, l_D/F: -1.02, l_D: -4.32, l_G: 1.02
INFO:root:Elapsed [9:37:29], Iteration [87/100]:
l_D/R: 3.63, l_D/F: -1.52, l_D: -4.33, l_G: 1.52
INFO:root:Elapsed [9:43:11], Iteration [88/100]:
l_D/R: 4.16, l_D/F: -0.60, l_D: -4.32, l_G: 0.60
INFO:root:Elapsed [9:48:52], Iteration [89/100]:
l_D/R: 3.81, l_D/F: -1.10, l_D: -4.34, l_G: 1.10
INFO:root:Elapsed [9:54:33], Iteration [90/100]:
l_D/R: 3.77, l_D/F: -1.24, l_D: -4.33, l_G: 1.24
INFO:root:Elapsed [10:00:15], Iteration [91/100]:
l_D/R: 3.93, l_D/F: -1.25, l_D: -4.37, l_G: 1.25
INFO:root:Elapsed [10:05:57], Iteration [92/100]:
l_D/R: 3.93, l_D/F: -1.17, l_D: -4.37, l_G: 1.17
INFO:root:Elapsed [10:11:39], Iteration [93/100]:
l_D/R: 3.80, l_D/F: -1.09, l_D: -4.39, l_G: 1.09
INFO:root:Elapsed [10:17:20], Iteration [94/100]:
l_D/R: 3.80, l_D/F: -1.37, l_D: -4.39, l_G: 1.37
INFO:root:Elapsed [10:23:02], Iteration [95/100]:
l_D/R: 4.01, l_D/F: -1.04, l_D: -4.41, l_G: 1.04
INFO:root:Elapsed [10:28:44], Iteration [96/100]:
l_D/R: 4.16, l_D/F: -0.82, l_D: -4.40, l_G: 0.82
INFO:root:Elapsed [10:34:26], Iteration [97/100]:
l_D/R: 3.93, l_D/F: -1.14, l_D: -4.41, l_G: 1.14
INFO:root:Elapsed [10:40:07], Iteration [98/100]:
l_D/R: 4.16, l_D/F: -0.85, l_D: -4.41, l_G: 0.85
INFO:root:Elapsed [10:45:49], Iteration [99/100]:
l_D/R: 3.98, l_D/F: -1.01, l_D: -4.43, l_G: 1.01
INFO:root:Saved model checkpoints into results/2023-04-07_21-37/models...
INFO:root:Elapsed [11:10:52], Iteration [100/100]:
l_D/R: 3.92, l_D/F: -1.16, l_D: -4.43, l_G: 1.16
property_match: 0.14
