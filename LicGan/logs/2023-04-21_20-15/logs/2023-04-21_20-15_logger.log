INFO:root:Namespace(lm_model='roberta-base', N=50, max_len=128, z_dim=8, mha_dim=768, n_heads=8, gen_dims=[[128, 256, 768], [512, 512]], disc_dims=[[128, 128], [512, 768], [512, 256, 128]], lambda_gp=5, lambda_rew=0, lambda_wgan=1, post_method='hard_gumbel', batch_size=128, num_epochs=100, g_lr=0.0002, d_lr=0.0002, b_lr=1e-05, dropout=0.0, n_critic=4, test_epochs=100, num_workers=1, mode='train', bert_unfreeze=0, data_dir='data/graphgen', saving_dir='results/2023-04-21_20-15', model_save_step=20, lr_update_step=1000, restore_G=None, restore_D=None, restore_B_D=None, restore_B_G=None, name='symm_fcn_final_ds_gumbel_roberta', log_dir='results/2023-04-21_20-15/logs', model_dir='results/2023-04-21_20-15/models')
INFO:root:Generator(
  (activation_f): ReLU()
  (multi_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=8, out_features=128, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=128, out_features=256, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
      (8): Linear(in_features=256, out_features=768, bias=True)
      (9): Dropout(p=0.0, inplace=False)
      (10): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (11): ReLU()
    )
  )
  (mha): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
  )
  (multi_dense_layer_2): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=768, out_features=512, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=512, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
    )
  )
  (adjM_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=512, out_features=256, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=256, out_features=2500, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((2500,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
    )
  )
  (node_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=512, out_features=64, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=64, out_features=50, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((50,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
    )
  )
)
INFO:root:G
INFO:root:The number of parameters: 4070306
INFO:root:Discriminator(
  (activation_f): ReLU()
  (multi_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=50, out_features=128, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=128, out_features=128, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
    )
  )
  (node_dense_layer): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=50, out_features=64, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=64, out_features=128, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
    )
  )
  (multi_dense_layer_2): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=6528, out_features=512, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=768, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
    )
  )
  (mha): MultiheadAttention(
    (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
  )
  (multi_dense_layer_3): MultiDenseLayer(
    (linear_layer): Sequential(
      (0): Linear(in_features=768, out_features=512, bias=True)
      (1): Dropout(p=0.0, inplace=False)
      (2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (3): ReLU()
      (4): Linear(in_features=512, out_features=256, bias=True)
      (5): Dropout(p=0.0, inplace=False)
      (6): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
      (7): ReLU()
      (8): Linear(in_features=256, out_features=128, bias=True)
      (9): Dropout(p=0.0, inplace=False)
      (10): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      (11): ReLU()
    )
  )
  (output_layer): Linear(in_features=128, out_features=1, bias=True)
)
INFO:root:D
INFO:root:The number of parameters: 6697153
INFO:root:RobertaModel(
  (embeddings): RobertaEmbeddings(
    (word_embeddings): Embedding(50265, 768, padding_idx=1)
    (position_embeddings): Embedding(514, 768, padding_idx=1)
    (token_type_embeddings): Embedding(1, 768)
    (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (encoder): RobertaEncoder(
    (layer): ModuleList(
      (0-11): 12 x RobertaLayer(
        (attention): RobertaAttention(
          (self): RobertaSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (output): RobertaSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (intermediate): RobertaIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): RobertaOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (pooler): RobertaPooler(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (activation): Tanh()
  )
)
INFO:root:roberta-base_G
INFO:root:The number of parameters: 124645632
INFO:root:RobertaModel(
  (embeddings): RobertaEmbeddings(
    (word_embeddings): Embedding(50265, 768, padding_idx=1)
    (position_embeddings): Embedding(514, 768, padding_idx=1)
    (token_type_embeddings): Embedding(1, 768)
    (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (encoder): RobertaEncoder(
    (layer): ModuleList(
      (0-11): 12 x RobertaLayer(
        (attention): RobertaAttention(
          (self): RobertaSelfAttention(
            (query): Linear(in_features=768, out_features=768, bias=True)
            (key): Linear(in_features=768, out_features=768, bias=True)
            (value): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
          (output): RobertaSelfOutput(
            (dense): Linear(in_features=768, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (intermediate): RobertaIntermediate(
          (dense): Linear(in_features=768, out_features=3072, bias=True)
          (intermediate_act_fn): GELUActivation()
        )
        (output): RobertaOutput(
          (dense): Linear(in_features=3072, out_features=768, bias=True)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
  )
  (pooler): RobertaPooler(
    (dense): Linear(in_features=768, out_features=768, bias=True)
    (activation): Tanh()
  )
)
INFO:root:roberta-base_D
INFO:root:The number of parameters: 124645632
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 5 nodes, min degree 1, 1 connected component, max diameter 3, 4 edges.
Results: [29, 754, 23, 38, 2, -20, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 10 nodes, 1 connected component, 10 edges, max diameter 5, max degree 4, min degree 1, with cycle.
Results: [27, 758, 24, 39, 2, -22, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 51 edges, max degree 15, min degree 1, max diameter 4, 1 connected component, 30 nodes, with cycle.
Results: [32, 782, 24, 38, 2, -17, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 1 connected component, 23 nodes, 54 edges, min degree 2, max diameter 4, with cycle, max degree 8.
Results: [26, 769, 23, 39, 2, -23, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max degree 13, 45 nodes, with cycle, 1 connected component, 116 edges.
Results: [34, 744, 23, 40, 2, -15, True]
--------------------------------------------------

INFO:root:Saved model checkpoints into results/2023-04-21_20-15/models...
INFO:root:Elapsed [0:04:00], Iteration [0/100]:
l_D/R: -0.13, l_D/F: -0.13, l_D: 9.81, l_G: 0.13, l_R: 851.98, l_R/N: 851.62, l_R/M: 0.36
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with max degree 3, without cycle, max diameter 3, 5 nodes, 1 connected component, 4 edges, min degree 1.
Results: [26, 697, 17, 42, 2, -23, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 1 connected component, max diameter 5, max degree 4, with cycle, 10 nodes, 10 edges.
Results: [30, 685, 16, 40, 2, -19, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 30 nodes, with cycle, min degree 1, 51 edges, max degree 15, max diameter 4.
Results: [33, 657, 15, 42, 2, -16, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with with cycle, 54 edges, min degree 2, max diameter 4, 23 nodes.
Results: [34, 693, 19, 41, 2, -15, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max diameter 11, 116 edges, min degree 1, 1 connected component, 45 nodes.
Results: [23, 698, 18, 45, 2, -26, True]
--------------------------------------------------

INFO:root:Elapsed [0:12:48], Iteration [1/100]:
l_D/R: 12.41, l_D/F: -13.32, l_D: -21.94, l_G: 13.32, l_R: 878.40, l_R/N: 878.11, l_R/M: 0.29
property_match: 0.12, closeness: 0.13, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.04, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 5 nodes, max diameter 3, 1 connected component, 4 edges, min degree 1.
Results: [29, 630, 18, 35, 2, -20, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 1 connected component, 10 nodes, min degree 1, max degree 4, with cycle, max diameter 5, 10 edges.
Results: [34, 631, 17, 38, 2, -15, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with with cycle, 1 connected component, 30 nodes, 51 edges.
Results: [28, 637, 18, 34, 2, -21, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 23 nodes, 54 edges, max degree 8, max diameter 4, min degree 2.
Results: [32, 681, 21, 35, 2, -17, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max diameter 11, 116 edges, 1 connected component, 45 nodes, with cycle.
Results: [31, 654, 19, 33, 2, -18, True]
--------------------------------------------------

INFO:root:Elapsed [0:21:33], Iteration [2/100]:
l_D/R: 26.74, l_D/F: -28.41, l_D: -41.27, l_G: 28.40, l_R: 869.24, l_R/N: 869.00, l_R/M: 0.24
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 5 nodes, without cycle, max degree 3, max diameter 3, 4 edges.
Results: [34, 613, 16, 33, 2, -15, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with min degree 1, 10 edges, 10 nodes, max diameter 5.
Results: [29, 635, 15, 33, 2, -20, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max degree 15, 51 edges, max diameter 4, 30 nodes, min degree 1, 1 connected component, with cycle.
Results: [26, 651, 17, 33, 2, -23, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 23 nodes, 1 connected component, max diameter 4, 54 edges, with cycle, min degree 2, max degree 8.
Results: [27, 614, 17, 31, 2, -22, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with min degree 1, max degree 13, 1 connected component, 116 edges, with cycle, 45 nodes, max diameter 11.
Results: [32, 633, 15, 36, 2, -17, True]
--------------------------------------------------

INFO:root:Elapsed [0:30:20], Iteration [3/100]:
l_D/R: 42.42, l_D/F: -41.64, l_D: -57.80, l_G: 41.67, l_R: 866.93, l_R/N: 866.69, l_R/M: 0.24
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 1 connected component, 4 edges, min degree 1, 5 nodes, without cycle.
Results: [33, 621, 18, 31, 2, -16, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with min degree 1, max degree 4, 10 nodes, with cycle, 10 edges.
Results: [33, 642, 19, 36, 2, -16, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 30 nodes, 51 edges, 1 connected component, max diameter 4, with cycle, min degree 1.
Results: [25, 616, 15, 31, 2, -24, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with with cycle, max diameter 4, 23 nodes, max degree 8, 1 connected component, 54 edges, min degree 2.
Results: [28, 630, 18, 34, 2, -21, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 45 nodes, 116 edges, max degree 13, min degree 1.
Results: [29, 633, 19, 35, 2, -20, True]
--------------------------------------------------

INFO:root:Elapsed [0:39:03], Iteration [4/100]:
l_D/R: 32.82, l_D/F: -21.10, l_D: -47.70, l_G: 21.13, l_R: 848.63, l_R/N: 848.39, l_R/M: 0.24
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 1 connected component, max degree 3, without cycle, 5 nodes, 4 edges, max diameter 3, min degree 1.
Results: [24, 646, 17, 33, 2, -25, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 10 edges, with cycle, min degree 1, max diameter 5, 10 nodes.
Results: [34, 627, 18, 30, 2, -15, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max degree 15, 51 edges, min degree 1, max diameter 4, with cycle, 30 nodes, 1 connected component.
Results: [35, 643, 18, 32, 2, -14, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 23 nodes, max degree 8, 1 connected component, min degree 2, with cycle, max diameter 4, 54 edges.
Results: [28, 623, 16, 34, 2, -21, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max diameter 11, 1 connected component, min degree 1, 45 nodes, max degree 13, with cycle, 116 edges.
Results: [28, 640, 20, 33, 2, -21, True]
--------------------------------------------------

INFO:root:Elapsed [0:47:48], Iteration [5/100]:
l_D/R: 45.40, l_D/F: -40.29, l_D: -61.47, l_G: 40.33, l_R: 876.93, l_R/N: 876.70, l_R/M: 0.24
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 1 connected component, 5 nodes, min degree 1, max degree 3, 4 edges.
Results: [30, 646, 19, 34, 2, -19, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max diameter 5, with cycle, 10 nodes, min degree 1, max degree 4, 10 edges.
Results: [28, 629, 19, 36, 2, -21, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 30 nodes, 51 edges, min degree 1, max diameter 4, max degree 15, with cycle.
Results: [29, 607, 14, 33, 2, -20, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 1 connected component, max diameter 4, with cycle, max degree 8, min degree 2, 54 edges, 23 nodes.
Results: [35, 660, 19, 32, 2, -14, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 45 nodes, with cycle, min degree 1, 116 edges.
Results: [32, 603, 18, 32, 2, -17, True]
--------------------------------------------------

INFO:root:Elapsed [0:55:28], Iteration [6/100]:
l_D/R: 44.93, l_D/F: -45.88, l_D: -65.43, l_G: 45.88, l_R: 854.20, l_R/N: 853.97, l_R/M: 0.23
property_match: 0.12, closeness: 0.13, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with min degree 1, 4 edges, without cycle, 5 nodes, max diameter 3.
Results: [21, 625, 16, 32, 2, -28, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max diameter 5, with cycle, min degree 1, 10 nodes, 1 connected component, 10 edges.
Results: [32, 629, 17, 32, 2, -17, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 30 nodes, with cycle, 51 edges, max degree 15, max diameter 4, min degree 1, 1 connected component.
Results: [27, 623, 16, 33, 2, -22, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with with cycle, 54 edges, max diameter 4, 23 nodes, min degree 2, max degree 8.
Results: [28, 640, 20, 36, 2, -21, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with with cycle, max diameter 11, min degree 1, 45 nodes, 116 edges.
Results: [27, 635, 18, 36, 2, -22, True]
--------------------------------------------------

INFO:root:Elapsed [1:04:11], Iteration [7/100]:
l_D/R: 59.93, l_D/F: -57.98, l_D: -69.04, l_G: 57.95, l_R: 831.68, l_R/N: 831.44, l_R/M: 0.23
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
INFO:root:5 sample adjacenecy matrices
--------------------------------------------------
Text: Undirected graph with 4 edges, min degree 1, 5 nodes, max diameter 3.
Results: [21, 617, 18, 32, 2, -28, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 10 edges, with cycle, 10 nodes, 1 connected component, max diameter 5, min degree 1.
Results: [27, 642, 15, 33, 2, -22, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 51 edges, 30 nodes, max degree 15, with cycle, max diameter 4.
Results: [28, 642, 20, 33, 2, -21, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with 54 edges, 23 nodes, with cycle, max diameter 4, 1 connected component, max degree 8.
Results: [29, 668, 18, 32, 2, -20, True]
--------------------------------------------------
--------------------------------------------------
Text: Undirected graph with max diameter 11, 116 edges, 1 connected component, with cycle, 45 nodes.
Results: [35, 656, 15, 35, 2, -14, True]
--------------------------------------------------

INFO:root:Elapsed [1:14:12], Iteration [8/100]:
l_D/R: 68.67, l_D/F: -58.56, l_D: -71.72, l_G: 58.56, l_R: 841.05, l_R/N: 840.82, l_R/M: 0.23
property_match: 0.12, closeness: 0.14, n_match: 0.01, m_match: 0.00, min_deg_match: 0.00, max_deg_match: 0.00, diam_match: 0.05, cc_match: 0.00, cycle_match: 0.61
